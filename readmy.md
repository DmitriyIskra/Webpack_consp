webpack для сжатия проекта для быстродействия

## ТЕРМИНЫ
1. сборка - это финальные файлы
2. граф зависимости - все файлы которые используются в проекте
3. точка входа в приложение index.js - инструкция, файл который говорит какой файл мы подключаем и где его использовать, точку входа можно поменять
    module.export = {
        entry: 'src/entry.js'
    }
    Точка входа не используется для написания исполняемого кода
4. Загрузщики - мы можем загружать и другие типы файлов не только js, для того чтобы webpack понимал эти файлы нужны загрузщики


## ПАПКИ
1. dist - итоговая папка
2. src - рабочая начальная папка

## КОРОТКИЙ ПЛАН ПОСТРОЕНИЯ
1. Инициализировать пакет проект
2. 


Инициализировали пакет

Установили webpack 
npm install --save-dev webpack webpack-cli

В script прописали команду для запуска и --mode production (есть режим сборки и режим разработки)

Создаем файл конфигурации webpack.config.js - он должен создаваться в той папке в которой будет запускаться webpack
В качетсве результата этот фай должен экспортировать объект, так как работаем с node.js пользоваться будем commonjs
module.export = {
    
}

Далее создаем точку входа, по умолчанию точкой входа должен являться файл index.js и находиться в папке src
Создаем папку src

Запускаем webpack происходит сборка создается папка dist (впоследствии можно переименовать/поменять) с файлом main.js (впоследствии можно переименовать)
Этот файл будет являться результатом сборки
Поменять 
module.export {
    output: {
        path: './dist',  // будет ошибка, путь должен быть в абсолютном формате
        filename:'app.bundle.js',
    },
}

Для абсолютного формата воспльзуемся стандартными ресурсами node.js
const path = require('path') пакет работает с абсолютными и относительными путями, у него есть метод resolve

module.export = {
    output: {
        path: path.resolve(__dirname, 'dist'),  // позволяет дать абсолютный путь, относительно текущего каталога
        filename:'app.bundle.js',
    }
}
И запустить webpack создасться нужный файл и папка




ДАЛЕЕ ОБУЧЕНИЕ WEBPACK РАБОТЕ С ФАЙЛАМИ КОТОРЫЕ БУДЕМ ПОДКЛЮЧАТЬ

Для этого в конфигурационном файле создадим module с правилами rules, где будем подключать загрузщики которые будут помогать webpack считывать файлы отличные от js
Для примера в рабочей папке src создадим текстовый файл data.txt

В точке входа пропишем что будем импортировать данные из этого файла

далее в rules указываем шаблон в виде регулярного выражения, webpack будет сравнивать импортируемый файл с шаблоном и будет понимать какой модуль и загрузщик использовать. test: /\.txt$/, далее указываем имя загрузщика и устанавливаем загрузщик

 ### Для чтения txt npm i --save-dev raw-loader

В точке входа выведем в консоль импортированный файл и запустим webpack получим в выходном файле вывод в консоль

(загрузщики создаются энтузиастами и только часть загрузщиков создана самим коллективом разработчиков webpack, загрузшики испоьзуются для работы с модулями для импорта и обработки, если этих возможностей не достаточно, существуют ПЛАГИНЫ)

Для сборки html файлов используется HtmlWebpackPlugin устанавливается через npm
Устанавливаем npm i --save-dev html-webpack-plugin.
### HTML --- HtmlWebpackPlugin

### CSS MiniCSSExtraPlugin
    npm i --save-dev mini-css-extract-plugin css-loader


Подключаем в конфиг


## РЕЖИМ ОТЛАДКИ

Чтобы включить режм отладки в script нужно убрать явное указание на --mode production (возможно есть дефис) и в config в mode указать development
Здесь можно посмотреть где что находится и если есть ошибка исправить ее


Чтобы посмотреть как работать с плагином можно воспользоваться npm repo ...



## Webpack-Dev-Server
Для работы c webpack есть свой сервер, можно использовать вместо live server
Установим
npm i --save-dev webpack-dev-server

Пропишем в скриптах, команду для быстрого запуска
"start": "webpack serve --mode development"


### Библиотека moment
npm run moment для работы со временем
в точке входа в консоли выведем текущее время
Делаем сборку и увидим в консоли количество милисекунд


## Babel in webpack
npm i --save-dev babel-loader
В конфиг нужно прописать правила

## webpack merge
npm i -D webpack-merge    -----    -D === --save-dev


________________

Чтобы не использовать точку входа для исполняемого кода можно использовать подключение стороннего файла
Создаем в src и импортируем его через точку входа

const commonConfig = { ... };    // Объект для общей сборки

const productionConfig = { ... }; // Объект для продакшн

const developmentConfig = { ... }; // Объект для отладочной сборки, например для подключения дополнительных опций к серверу

module.exports = (env, args) => { 
    if(env.development) {
        return merge(commonConfig, developmentConfig);
    }
    else {
        return merge(commonConfig, productionConfig);
    }
} --- как работает: экспортируется функция и в зависимоти от того что передается development или production передаются настройки

module.exports = (env, args) => { 
  switch(args.mode) {
    case 'development':
      return merge(commonConfig, developmentConfig);
    case 'production':
      return merge(commonConfig, productionConfig);
    default:
      throw new Error('No matching configuration was found!');
  }
}  --- может быть устаревшее

Для получения информации мы будем в конфиг использовать модули.
Создадим в src три файла
  - webpack.common.config.js  ---  общий файл, сюда перемещаем из конфига общую информацию. 
  - webpack.production.config.js
  - webpack.development.config.js


особенность webpack это его быстрое обновление и иногда документация не успевает за обновлениями и получается мы все делаем по документации, а что то не работает. Новые версии webpack могут быть не совместимы с загрузщиками плагинами, поэтому нужно стараться аккуратно относиться к обновлению новой версии всего пакета.